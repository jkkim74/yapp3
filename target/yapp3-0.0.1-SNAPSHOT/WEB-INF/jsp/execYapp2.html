<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>Insert title here</title>
	<script>
	    var ios_appstoreid = "1331731129";
	    var android_packagename = "com.kt.y";
	    var android_marketUrl = "market://details?id=com.kt.y";
	    var android_appUrl = "yboxapp://yboxapp";
	    var android_intent = "intent://yboxapp/#Intent;scheme=yboxapp;package=com.kyad.offerwall.appall;end";
	    var android_version_suffix = "&ver=1";
	    var ios_version_suffix = "&ver=1";
	    var type = qs("type");
	    var datukid = qs("datukid");
	    alert("type=|" + type + "|, datukid = |" + datukid + "|");
	
	    function isIOS(){
	        var userAgent = navigator.userAgent.toLowerCase();
	        return ((userAgent.search("iphone") > -1) || (userAgent.search("ipod") > -1) || (userAgent.search("ipad") > -1));
	    }
	    function isSafari(){
	        var userAgent = navigator.userAgent.toLowerCase();
	        return (userAgent.search("safari") > -1);
	    }
	
	    function go_iOS_AppStore(){
	        app_store_url = "https://itunes.apple.com/kr/app/id" + ios_appstoreid + "?mt=8";
	        window.top.location.href = app_store_url;
	    }
	
	    function KTYSHARE_showToast(str) {
	        if (isIOS()){
	            setTimeout(function () {
	                window.location.href = "yboxapp://showToast?msg=" + encodeURIComponent(str) + ios_version_suffix;
	            }, 50);
	            setTimeout( function() {
	                go_iOS_AppStore();
	            }, 500);
	            return;
	        }
	        if (typeof yboxapp == 'undefined') {
	            if(is_android_web()){
	                var url = "Intent://yboxapp?msg=" + encodeURIComponent(str) + android_version_suffix;
	                url += "#Intent;scheme=yboxapp;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=" + android_packagename + ";end";
	                android_intent = url;
	                launch_app_or_alt_url();
	            } else {
	                alert(str);
	                return;
	            }
	        }
	        yboxapp.showToast(str);
	    }
	
	    function KTYSHARE_share() {
	        if (isIOS()){
	            setTimeout(function () {
	                var target_url = "yboxapp://ios?type=" + encodeURIComponent(type) + "&datukid=" + encodeURIComponent(datukid) + ios_version_suffix;
	                window.top.location.href = target_url;
	            }, 50);
	            setTimeout( function() {
	                go_iOS_AppStore();
	            }, 500);
	            return;
	        }
	        if (typeof yboxapp == 'undefined') {
	            if(is_android_web()){
	                var url = "Intent://yboxapp?type=" + encodeURIComponent(type) + "&datukid=" + encodeURIComponent(datukid) + android_version_suffix;
	                url += "#Intent;scheme=yboxapp;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=" + android_packagename + ";end";
	                android_intent = url;
	                launch_app_or_alt_url();
	            } else {
	                alert("No Mobile Browser!!!");
	            }
	            return;
	        }
	        yboxapp.share(type, datukid);
	    }
	
	    function openInNewTab(url) {
	        var win = window.open(url, '_blank');
	        win.focus();
	    }
	
	    function is_android_web(){
	        var userAgent = navigator.userAgent.toLowerCase();
	        return ((typeof yboxapp == 'undefined') && (userAgent.search("android") > -1));
	    }
	
	    var timer;
	    var heartbeat;
	    var iframe_timer;
	
	    function clearTimers() {
	        clearTimeout(timer);
	        clearTimeout(heartbeat);
	        clearTimeout(iframe_timer);
	    }
	
	    function intervalHeartbeat() {
	        if (document.webkitHidden || document.hidden) {
	            clearTimers();
	        }
	    }
	
	    function tryIframeApproach() {
	        var iframe = document.createElement("iframe");
	        iframe.style.border = "none";
	        iframe.style.width = "1px";
	        iframe.style.height = "1px";
	        iframe.onload = function () {
	            window.top.location.href = android_marketUrl;
	        };
	        iframe.src = android_appUrl;
	        document.body.appendChild(iframe);
	    }
	
	    function tryWebkitApproach() {
	        window.top.location.href = android_appUrl;
	        timer = setTimeout(function () {
	            window.top.location.href = android_marketUrl;
	        }, 2500);
	    }
	
	    function launch_app_or_alt_url() {
	        heartbeat = setInterval(intervalHeartbeat, 200);
	        if (navigator.userAgent.match(/Chrome/)) {
	            window.top.location.href = android_intent;
	        } else if (navigator.userAgent.match(/Firefox/)) {
	            tryWebkitApproach();
	            iframe_timer = setTimeout(function () {
	                tryIframeApproach();
	            }, 1500);
	        } else {
	            tryIframeApproach();
	        }
	    }
	</script>
</head>
<body onload="KTYSHARE_share()">
</body>
</html>
